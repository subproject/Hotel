<!--HEADER-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
    <title></title>
    <style type="text/css">
        .style6
        {
            width: 117px;
        }
        .contenttable
        {
            width: 100%;
            border-collapse: collapse;
        }
        .contenttable tr td
        {
            text-align: left;
            border-style: solid;
            border-color: #000;
            border-width: 1px;
            font-size:14px;
            padding:3px;
        }
        .footer
        {
            width: 100%;
            border-collapse: collapse;
            border: solid 1px #000;
        }
        .style18
        {
            width: 18%;
        }
        .style19
        {
            width: 12%;
        }
        .style21
        {
            width: 170px;
        }
        .style23
        {
            width: 14%;
        }
        .style24
        {
            width: 73px;
        }
        </style>
    <style type="text/css" media="print">.noprint { DISPLAY: none }</style>
    <link rel="stylesheet" type="text/css" href="../themes/default/easyui.css" />
    <link rel="stylesheet" type="text/css" href="../themes/icon.css" />
    <link rel="stylesheet" type="text/css" href="../themes/demo.css" />
    <script type="text/javascript" src="../jquery-1.8.0.min.js"></script>
    <script type="text/javascript" src="../jquery.easyui.min.js"></script>
</head>
<body>
    <div style="width:670px;max-width:100%;min-width:1000px;margin:auto">
    <div class="noprint">
        <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-print',plain:true" onclick="printDoc()">打印</a>
        <a href="javascript:void(0)" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:true" onclick="closeWindow()">关闭</a>
    </div>
    <table width="100%" style="border-collapse:collapse;">
        <tr>
            <td style="text-align: center; font-size: 20px; font-weight: bold">
                <span style="padding-left:10px;font-size: 20px;">销售毛利统计表</span>
            </td>
        </tr>
        <tr>
            <td style="text-align:center; font-size:20px; font-weight:bold;height:20px;">
                
            </td>
        </tr>
      
    </table>
    <table id="bodyHeader" class="contenttable" width="100%" align="center" style="margin-top:10px;">
        <tr id="column">
            <td class="style18" style="width:15%;text-align:center;">
                商品名称
            </td>
            <td class="style23" style="width:15%;text-align:center;">
                单位
            </td>
            <td class="style6" style="width:8%;text-align:center;">
                数量
            </td>
            <td class="style6" style="width:19%;text-align:center;">
                成本单价
            </td>
            <td class="style6" style="width:4%;text-align:center;">
               销售成本
            </td>
            <td class="style19" style="width:9%;text-align:center;">
                平均售价
            </td>
           
            <td class="style6" style="width:15%;text-align:center;">
                销售额
            </td>
            <td class="style6" style="width:15%;text-align:center;">
                毛利
            </td>
        </tr>
    </table>
    <!--HEADER-->
    <!--BODY-->
    <table id="rows" class="contenttable" width="100%" align="center">
        <tr id="Tr1">
            <td id="Td1" 
                style="text-align:center; border-right-style: none;width:15%; border-right-color: inherit; border-right-width: 0px; border-top-style: none; border-top-color: inherit; border-top-width: 0px;" 
                class="style18">{goodsName}</td>
            <td id="Td2" 
                style="text-align:center; border-right-style: none;width:15%; border-right-color: inherit; border-right-width: 0px; border-top-style: none; border-top-color: inherit; border-top-width: 0px;" 
                class="style23">
                {unit}</td>
            <td id="Td3"  class="style6" style="text-align:center;width:8%;border-right:0px;border-top:0px;">
                {saleCount}</td>
            <td id="Td4" class="style6" style="text-align:center;width:19%;border-right:0px;border-top:0px;">
                {inPrice}</td>
            <td id="Td5" class="style6" style="text-align:right;width:4%;border-right:0px;border-top:0px;">
                {inTotal}</td>
            <td id="Td6" class="style19" style="text-align:right;width:9%;border-right:0px;border-top:0px;">
                {agvSalePrice}</td>
            
               <td id="Td7" class="style6" style="text-align:center;width:15%;border-top:0px;">{saleTotal}</td>
          <td id="Td8" class="style6" style="text-align:center;width:15%;border-top:0px;">{grossProfit}</td>
        
        </tr>
    </table>
    <!--BODY-->
    <!--FOOTER-->
   
    </div>
</body>
</html>
<!--FOOTER-->
<script type="text/javascript">
    window.onload = function () {
        
        var printData = window.opener.getPrintData();
       
        var inner = document.body.innerHTML;
        for (var it in printData) {
            if (typeof (printData[it]) == "object") {
                continue;
            } else {
              
                inner = inner.replace(new RegExp("{" + it + "}", "ig"), printData[it]);
            }
        }
        document.body.innerHTML = inner;
        var temp = document.getElementById("rows");
        var tempRow = temp.children[0];
        temp.removeChild(tempRow);
        var rows = printData["rows"];
       
        for (var i = 0; i < rows.length; i++) {
            var itemInner = tempRow.innerHTML;
            for (var r in rows[i]) {
                itemInner = itemInner.replace(new RegExp("{" + r + "}", "ig"), rows[i][r]);
            }
            temp.innerHTML += itemInner;
        }
    };
    window.onbeforeunload = function () {
        event.returnValue = false;
        return "请确认已经打印完成，是否继续操作?";
    };
    function printPreviewDoc() {
        //window.printPreview();
        //Web.ExecWB(6, 1)
        wb.ExecWB(7, 1);
        //execwb(8, 1);
    }
    function printDoc() {
        window.print();
    }
    function closeWindow() {
        window.close();
    }
</script>
